<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#ffffff">
    <title>{{TITLE}}</title>
    
    <!-- RSS and Atom Feed Discovery -->
    <link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/feed.xml">
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/atom.xml">
    
    {{MATHJAX}}
    
    <style>
        /* Color Variables */
        :root {
            --bg-color: #fefefe;
            --text-color: #454545;
            --link-color: #0077aa;
            --link-visited-color: #0077aa;
            --heading-color: #333;
            --code-bg: #f5f5f5;
            --border-color: #ddd;
            --quote-color: #456;
            --accent-color: #0077aa;
            --wrong-color: #c0392b;
            --highlight-color: #730000;
        }
        
        html {
            background-color: var(--bg-color);
        }
        
        body {
            font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            color: var(--text-color);
            font-size: 16px;
            line-height: 1.4;
            max-width: 800px;
            margin: 2em auto;
            padding: 1em;
            padding-right: 1em;
            -webkit-hyphens: auto;
            -ms-hyphens: auto;
            hyphens: auto;
        }
        
        /* Add space for TOC on larger screens */
        @media screen and (min-width: 1400px) {
            body {
                margin-right: 300px;
            }
        }
        
        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            line-height: 1.2;
            color: var(--heading-color);
            margin-top: 1.5em;
        }
        
        h1 {
            font-size: 2.5em;
            margin-top: 0;
            text-align: center;
        }
        
        h2 {
            font-size: 2em;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 0.3em;
        }
        
        h3 {
            font-size: 1.5em;
        }
        
        p {
            margin: 1em 0;
        }
        
        /* Links */
        a {
            color: var(--link-color);
            text-decoration: none;
        }
        
        a:hover {
            text-decoration: underline;
        }
        
        a:visited {
            color: var(--link-visited-color);
        }
        
        /* External link icon */
        a[href^="http"]::after,
        a[href^="https://"]::after {
            content: " üîó";
        }
        
        /* Don't show icon for internal links and tags */
        a.tag::after,
        a.tag-link::after {
            content: none;
        }
        
        /* Navigation */
        .nav-home {
            position: fixed;
            top: 10px;
            right: 10px;
            font-size: 0.9em;
            background-color: rgba(254, 254, 254, 0.95);
            padding: 8px 15px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        
        .nav-home a {
            color: var(--link-color);
            text-decoration: none;
            font-weight: 500;
        }
        
        .nav-home a:hover {
            text-decoration: underline;
        }
        
        /* Table of Contents - Fixed Sidebar */
        .toc {
            position: fixed;
            top: 80px;
            right: 60px;
            width: 200px;
            max-height: calc(100vh - 100px);
            overflow-y: auto;
            background-color: var(--code-bg);
            border-left: 4px solid var(--accent-color);
            padding: 0.8em 1em;
            border-radius: 2px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            z-index: 100;
        }
        
        .toc h2 {
            margin-top: 0;
            font-size: 1em;
            border-bottom: none;
            padding-bottom: 0;
            color: var(--heading-color);
        }
        
        .toc ul {
            list-style-type: none;
            padding-left: 0;
            margin: 0.5em 0;
            font-size: 0.95em;
        }
        
        .toc ul ul {
            padding-left: 1.5em;
            margin-top: 0.3em;
        }
        
        .toc li {
            margin: 0.4em 0;
        }
        
        .toc a {
            color: var(--text-color);
            text-decoration: none;
        }
        
        .toc a:hover {
            color: var(--link-color);
        }
        
        /* Active TOC link */
        .toc a.active {
            color: var(--accent-color);
            font-weight: 600;
        }
        
        /* Code Blocks */
        pre {
            background-color: var(--code-bg);
            border-left: 4px solid var(--accent-color);
            padding: 1em;
            overflow-x: auto;
            line-height: 1.5;
            border-radius: 2px;
            margin: 1.5em 0;
        }
        
        code {
            font-family: "SF Mono", "Fira Code", "Consolas", "Monaco", "Courier New", monospace;
            background-color: var(--code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
            font-size: 0.9em;
        }
        
        pre code {
            background-color: transparent;
            padding: 0;
        }
        
        /* Blockquotes */
        blockquote {
            color: var(--quote-color);
            margin-left: 0;
            margin-top: 2em;
            margin-bottom: 2em;
            padding-left: 1.5em;
            border-left: 4px solid var(--accent-color);
        }
        
        blockquote p {
            margin: 0.5em 0;
        }
        
        /* Lists */
        ul, ol {
            line-height: 1.6;
            margin: 1em 0;
            padding-left: 2em;
        }
        
        li {
            margin: 0.5em 0;
        }
        
        /* Post List on Homepage */
        .post-list {
            list-style: none;
            padding-left: 0;
        }
        
        .post-list li {
            margin: 1em 0;
            padding: 0.5em 0;
            border-bottom: 1px solid #eee;
        }
        
        .post-list-date {
            color: #999;
            font-size: 0.9em;
            font-family: monospace;
        }
        
        .subtitle {
            font-size: 1.1em;
            color: #666;
            font-style: italic;
            margin-top: -0.5em;
        }
        
        /* Post Date */
        .post-date {
            color: #666;
            font-style: italic;
            margin-top: -0.5em;
            font-size: 0.95em;
            text-align: center;
        }
        
        /* Tags */
        .tags {
            text-align: center;
            margin: 0.5em 0 1.5em 0;
        }
        
        .tags-inline {
            display: inline-block;
            margin-left: 0.5em;
        }
        
        .tag {
            display: inline-block;
            background-color: var(--code-bg);
            color: var(--accent-color);
            padding: 0.2em 0.6em;
            margin: 0.2em;
            border-radius: 3px;
            font-size: 0.85em;
            font-weight: 500;
            border: 1px solid var(--border-color);
            text-decoration: none;
            transition: background-color 0.2s, color 0.2s;
        }
        
        a.tag:hover {
            background-color: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }
        
        /* Tags List Page */
        .tags-list {
            list-style: none;
            padding-left: 0;
            margin: 2em 0;
        }
        
        .tags-list li {
            margin: 1em 0;
            padding: 0.8em;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .tag-link {
            font-size: 1.2em;
            font-weight: 500;
            color: var(--accent-color);
            text-decoration: none;
        }
        
        .tag-link:hover {
            text-decoration: underline;
        }
        
        .tag-count {
            color: #999;
            font-size: 0.9em;
        }
        
        /* Horizontal Rule */
        hr {
            border: none;
            border-top: 2px solid var(--border-color);
            margin: 3em 0;
        }
        
        /* Images */
        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 1.5em auto;
            border-radius: 4px;
        }
        
        /* Tables */
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 1.5em 0;
            overflow-x: auto;
            display: block;
        }
        
        table th,
        table td {
            border: 1px solid var(--border-color);
            padding: 0.6em 0.8em;
            text-align: left;
        }
        
        table th {
            background-color: var(--code-bg);
            font-weight: 600;
        }
        
        table tr:nth-child(even) {
            background-color: #fafafa;
        }
        
        /* Emphasis */
        em {
            font-style: italic;
        }
        
        strong {
            font-weight: 600;
            color: var(--heading-color);
        }
        
        /* Special spans */
        .highlight {
            color: var(--highlight-color);
            font-weight: 500;
        }
        
        .wr {
            color: var(--wrong-color);
            font-weight: 600;
        }
        
        /* Responsive Design */
        @media screen and (max-width: 1200px) {
            .toc {
                display: none;
            }
        }
        
        @media screen and (max-width: 500px) {
            body {
                font-size: 14px;
                padding: 0.5em;
                margin: 1em auto;
            }
            
            h1 {
                font-size: 2em;
            }
            
            h2 {
                font-size: 1.6em;
            }
            
            .nav-home {
                position: absolute;
                right: 5px;
                top: 5px;
            }
            
            pre {
                padding: 0.5em;
            }
        }
        
        /* MathJax Math Formula Styles */
        mjx-container {
            overflow-x: auto;
            overflow-y: hidden;
            font-size: 105% !important;
        }
        
        mjx-container[display="block"] {
            display: block;
            text-align: center;
            margin: 1em 0;
        }
        
        /* ===== Back to Top Button - START ===== */
        /*
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 260px;
            width: 45px;
            height: 45px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s, background-color 0.3s;
            z-index: 99;
        }
        
        .back-to-top.show {
            opacity: 1;
            visibility: visible;
        }
        
        .back-to-top:hover {
            background-color: var(--heading-color);
        }
        
        @media screen and (max-width: 1200px) {
            .back-to-top {
                right: 20px;
                margin-right: 0;
            }
        }
        */
        /* ===== Back to Top Button - END ===== */
    </style>
</head>
<body>
    {{NAV}}
    <h1>{{TITLE}}</h1>
    {{DATE}}
    {{TAGS}}
    {{TOC}}
    {{CONTENT}}
    
    <!-- Article License Notice -->
    <div style="margin-top: 3em; padding: 1.5em; background-color: #f8f9fa; border-left: 4px solid var(--accent-color); border-radius: 4px; font-size: 0.9em; color: #666;">
        <p style="margin: 0 0 0.5em 0; font-weight: 500; color: #333;">üìÑ License</p>
        <p style="margin: 0;">
            This article is licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener noreferrer" style="color: var(--accent-color);">CC BY-SA 4.0</a>.
        </p>
    </div>
    
    <!-- ===== Back to Top Button - START ===== -->
    <!--
    <button class="back-to-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" title="Back to top">‚Üë</button>
    -->
    <!-- ===== Back to Top Button - END ===== -->
    
    <script>
    /* ===== Back to Top Button JavaScript - START ===== */
    /*
    // Show/hide back to top button
    const backToTopBtn = document.querySelector('.back-to-top');
    window.addEventListener('scroll', () => {
        if (window.pageYOffset > 300) {
            backToTopBtn.classList.add('show');
        } else {
            backToTopBtn.classList.remove('show');
        }
    });
    */
    /* ===== Back to Top Button JavaScript - END ===== */
    
    // Highlight active section in TOC
    if (document.querySelector('.toc')) {
        /* ===== ÊñπÊ°à1: IntersectionObserver (Â∑≤Ê≥®Èáä) =====
        const observer = new IntersectionObserver(entries => {
            entries.forEach(entry => {
                const id = entry.target.getAttribute('id');
                if (id) {
                    const tocLink = document.querySelector(`.toc a[href="#${id}"]`);
                    if (tocLink) {
                        if (entry.isIntersecting) {
                            document.querySelectorAll('.toc a').forEach(link => link.classList.remove('active'));
                            tocLink.classList.add('active');
                        }
                    }
                }
            });
        }, { rootMargin: '-20% 0px -80% 0px' });
        
        document.querySelectorAll('h2[id], h3[id], h4[id]').forEach(heading => {
            observer.observe(heading);
        });
        ===== ÊñπÊ°à1 END ===== */
        
        // ===== ÊñπÊ°à2: Scroll Event (ÂΩìÂâç‰ΩøÁî®) =====
        const headings = document.querySelectorAll('h2[id], h3[id], h4[id]');
        const tocLinks = document.querySelectorAll('.toc a');
        
        function updateActiveTocLink() {
            let current = '';
            const scrollPosition = window.scrollY + 100; // Ë∑ùÁ¶ªÈ°∂ÈÉ® 100px Êó∂Ëß¶Âèë
            
            // Ê£ÄÊü•ÊòØÂê¶ÊªöÂà∞Â∫ïÈÉ®
            if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 10) {
                // ÊªöÂà∞Â∫ïÈÉ®ÔºåÊøÄÊ¥ªÊúÄÂêé‰∏Ä‰∏™Ê†áÈ¢ò
                if (headings.length > 0) {
                    current = headings[headings.length - 1].getAttribute('id');
                }
            } else {
                // Ê≠£Â∏∏ÊªöÂä®ÔºåÊâæÂà∞ÂΩìÂâçÂèØËßÅÁöÑÊ†áÈ¢ò
                headings.forEach(heading => {
                    const headingTop = heading.offsetTop;
                    if (scrollPosition >= headingTop) {
                        current = heading.getAttribute('id');
                    }
                });
            }
            
            // Êõ¥Êñ∞ active Áä∂ÊÄÅ
            tocLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('active');
                }
            });
        }
        
        // ÊªöÂä®Êó∂Êõ¥Êñ∞
        window.addEventListener('scroll', updateActiveTocLink);
        // È°µÈù¢Âä†ËΩΩÊó∂Êõ¥Êñ∞
        updateActiveTocLink();
        // ===== ÊñπÊ°à2 END =====
    }
    </script>
</body>
</html>
